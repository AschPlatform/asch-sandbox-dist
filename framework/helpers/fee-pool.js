"use strict";function _classCallCheck(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var _slicedToArray=function(){function r(r,e){var t=[],n=!0,a=!1,i=void 0;try{for(var o,u=r[Symbol.iterator]();!(n=(o=u.next()).done)&&(t.push(o.value),!e||t.length!==e);n=!0);}catch(r){a=!0,i=r}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}return t}return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return r(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function r(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),bignum=require("bignumber"),MODEL_NAME="RoundFee",FeePool=function(){function r(e){_classCallCheck(this,r),this.sdb=e,this.round=1}return _createClass(r,[{key:"setRound",value:function(r){this.round=r}},{key:"add",value:function(r,e){var t={round:this.round,currency:r},n=this.sdb.get(MODEL_NAME,t);if(n){var a=bignum(n.amount).plus(e).toString();this.sdb.update(MODEL_NAME,{amount:a},t)}else t.amount=e,this.sdb.create(MODEL_NAME,t)}},{key:"getFees",value:function(){var r=this.sdb.entries(MODEL_NAME),e=new Map,t=!0,n=!1,a=void 0;try{for(var i,o=r[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var u=_slicedToArray(i.value,2),l=u[0],s=u[1],c=l.split(","),f=_slicedToArray(c,2),d=f[0],y=f[1],h=Number(d.split(":")[1]),b=y.split(":")[1];h===this.round&&e.set(b,s.amount)}}catch(r){n=!0,a=r}finally{try{!t&&o.return&&o.return()}finally{if(n)throw a}}return e}}]),r}();module.exports=FeePool;