"use strict";function Sequence(e){var n={onWarning:null,warningLimit:300};n=extend(n,e);var t=this;this.sequence=[],this.counter=1,this.name=e.name,setImmediate(function e(){n.onWarning&&t.sequence.length>=n.warningLimit&&n.onWarning(t.sequence.length,n.warningLimit),t.__tick(function(){setTimeout(e,3)})})}var util=require("util"),extend=require("extend");Sequence.prototype.__tick=function(e){var n=this.sequence.shift();if(!n)return setImmediate(e);var t=[function(t,i){n.done&&setImmediate(n.done,t,i),setImmediate(e)}];n.args&&(t=t.concat(n.args)),n.worker.apply(n.worker,t)},Sequence.prototype.add=function(e,n,t){if(!t&&n&&"function"==typeof n&&(t=n,n=void 0),e&&"function"==typeof e){var i={worker:e,done:t};util.isArray(n)&&(i.args=n),i.counter=this.counter++,this.sequence.push(i)}},Sequence.prototype.count=function(){return this.sequence.length},module.exports=Sequence;