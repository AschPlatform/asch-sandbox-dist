"use strict";function Sql(r,e){library=e,r(null,self=this)}var util=require("util"),private_={},self=null,library=null,modules=null;private_.row2object=function(r){for(var e={},t=this.length,a=0;a<t;a++)e[this[a]]=r[this[a]];return e},private_.row2parsed=function(r){var e=[],t=!0,a=!1,l=void 0;try{for(var n,s=Object.keys(r)[Symbol.iterator]();!(t=(n=s.next()).done);t=!0){var o=n.value;e.push(r[o])}}catch(r){a=!0,l=r}finally{try{!t&&s.return&&s.return()}finally{if(a)throw l}}for(var i={},u=null,p=this.f,c=this.p,f=p.length,v=0;v<f;v++)u=e[v],c[v]===Buffer?i[p[v]]=c[v](u,"hex"):c[v]===Array?i[p[v]]=e?u.split(","):[]:u&&(i[p[v]]=c[v](u));return i},private_.parseFields=function(r){for(var e,t=Object.keys(r),a=[],l=t.length,n=0;n<l;n++)e=r[t[n]],a[n]=e===Boolean?Boolean:e===Date?Date:e||String;return{f:t,p:a}},Sql.prototype.select=function(r,e,t){"function"==typeof e&&(t=e,e=null);var a={call:"sql#select",args:r};library.sandbox.sendMessage(a,function(r,a){e&&!r&&(a=util.isArray(e)?a.map(private_.row2object,e):a.map(private_.row2parsed,private_.parseFields(e))),t(r,a)})},Sql.prototype.insert=function(r,e){var t={call:"sql#insert",args:r};library.sandbox.sendMessage(t,e)},Sql.prototype.batch=function(r,e){var t={call:"sql#batch",args:r};library.sandbox.sendMessage(t,e)},Sql.prototype.update=function(r,e){var t={call:"sql#update",args:r};library.sandbox.sendMessage(t,e)},Sql.prototype.remove=function(r,e){var t={call:"sql#remove",args:r};library.sandbox.sendMessage(t,e)},Sql.prototype.onBind=function(r){modules=r},module.exports=Sql;